# Maintainer: ArchStrike <team@archstrike.org>
#Automatically generated by pip2arch on 2016-05-24

pkgname=binjitsu-git
pkgver=20160521.r2467
pkgrel=1
pkgdesc="binjitsu is a CTF framework and exploit development library. Written in Python, it is designed for rapid prototyping and development, and intended to make exploit writing as simple as possible."
url="https://github.com/binjitsu/binjitsu/"
depends=('python2-dateutil' 'python2-paramiko' 'python2-mako' 'python2-pyelftools' 'capstone' 'ropgadget' 'python2-pyserial' 'python2-requests' 'python2-pygments' 'python2-pysocks')
makedepends=('git' 'python2-setuptools')
license=('CUSTOM')
arch=('any')
replaces=('pwntools')
provides=('pwntools')
source=("$pkgname::git+https://github.com/binjitsu/binjitsu.git")
sha512sums=('SKIP')

pkgver() {
  cd $pkgname
  printf "%s.r%s" "$(git show -s --format=%ci master | sed 's/\ .*//g;s/-//g')" "$(git rev-list --count HEAD)"
}

build() {
    cd $pkgname
    python2 setup.py build
}

package() {
    cd $pkgname
    python2 setup.py install --root="$pkgdir" --optimize=1 
    # fix python issues
    sed -i 's|python|python2|' $pkgdir/usr/lib/python2.7/site-packages/pwnlib/elf/datatypes.py
    install -Dm644 LICENSE-binjitsu.txt $pkgdir/usr/share/licenses/$pkgname/LICENSE-binjitsu.txt
    install -Dm644 LICENSE-pwntools.txt $pkgdir/usr/share/licenses/$pkgname/LICENSE-pwntools.txt
}
